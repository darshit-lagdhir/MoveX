# ═══════════════════════════════════════════════════════════════════════════════
# MOVEX ENVIRONMENT CONFIGURATION
# ═══════════════════════════════════════════════════════════════════════════════
#
# Copy this file to .env and fill in your values.
# NEVER commit .env to git - it contains secrets!
#
# Generate secrets with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#
# ═══════════════════════════════════════════════════════════════════════════════

# ─────────────────────────────────────────────────────────────────────────────────
# APPLICATION
# ─────────────────────────────────────────────────────────────────────────────────
NODE_ENV=development
# Options: 'development' or 'production'
# Production enables: HTTPS cookies, HSTS headers, stricter error handling

PORT=4000
# The port the backend server listens on

# ─────────────────────────────────────────────────────────────────────────────────
# DATABASE (PostgreSQL / Supabase)
# ─────────────────────────────────────────────────────────────────────────────────

# OPTION 1: Connection URL (recommended for Supabase, Railway, Heroku, etc.)
# Format: postgresql://USER:PASSWORD@HOST:PORT/DATABASE?sslmode=require
DATABASE_URL=postgresql://postgres:YOUR_PASSWORD@db.YOUR_PROJECT.supabase.co:6543/postgres?sslmode=require

# OPTION 2: Individual credentials (fallback if DATABASE_URL not set)
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=your_local_password
DB_NAME=movex_auth
DB_SSL=false
# Set DB_SSL=true for cloud databases that require SSL

# Connection Pool Settings (optional - sensible defaults provided)
# DB_POOL_MAX=10
# DB_POOL_MIN=2
# DB_STATEMENT_TIMEOUT=30000

# ─────────────────────────────────────────────────────────────────────────────────
# AUTHENTICATION & SESSIONS
# ─────────────────────────────────────────────────────────────────────────────────

# CRITICAL: Both secrets MUST be unique, random, 32+ characters
# Generate: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
JWT_SECRET=CHANGE_THIS_TO_64_CHARACTER_RANDOM_HEX_STRING_MUST_BE_UNIQUE
SESSION_SECRET=CHANGE_THIS_TO_DIFFERENT_64_CHARACTER_RANDOM_HEX_STRING

# Session lifetime in milliseconds (default: 2 hours)
SESSION_MAX_AGE=7200000

# JWT expiration (default: 2 hours)
JWT_EXPIRES_IN=2h

# ─────────────────────────────────────────────────────────────────────────────────
# SECURITY
# ─────────────────────────────────────────────────────────────────────────────────

# Enable CSRF token validation on state-changing requests
CSRF_ENABLED=false
# Set to 'true' in production if using CSRF tokens

# Cookie security settings
SESSION_SECURE=false
# Set to 'true' in production (requires HTTPS)

SESSION_SAME_SITE=Lax
# Options: 'Strict', 'Lax', or 'None'

# ─────────────────────────────────────────────────────────────────────────────────
# RATE LIMITING
# ─────────────────────────────────────────────────────────────────────────────────

# Maximum attempts per 15-minute window
RATE_LIMIT_LOGIN=5
RATE_LIMIT_REGISTER=3
RATE_LIMIT_FORGOT_PASSWORD=3
RATE_LIMIT_GENERAL=100

# ─────────────────────────────────────────────────────────────────────────────────
# PASSWORD RESET
# ─────────────────────────────────────────────────────────────────────────────────

# How long password reset tokens are valid (minutes)
RESET_TOKEN_EXPIRY_MINUTES=15

# URL for the password reset page (for email links, if using email)
FRONTEND_RESET_URL=http://localhost:4000/reset-password.html

# ─────────────────────────────────────────────────────────────────────────────────
# SUPABASE STORAGE (for photo uploads)
# ─────────────────────────────────────────────────────────────────────────────────

# Your Supabase project URL
SUPABASE_URL=https://YOUR_PROJECT.supabase.co

# Public anon key (safe to expose - limited permissions)
SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# Service role key (BACKEND ONLY - never expose to frontend!)
SUPABASE_SERVICE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# Storage bucket name for shipment photos
STORAGE_BUCKET=shipment-photos

# ─────────────────────────────────────────────────────────────────────────────────
# EMAIL (SMTP) - Optional, for password reset emails
# ─────────────────────────────────────────────────────────────────────────────────

# SMTP_HOST=smtp.sendgrid.net
# SMTP_PORT=587
# SMTP_USER=apikey
# SMTP_PASS=YOUR_SENDGRID_API_KEY

# ─────────────────────────────────────────────────────────────────────────────────
# FRONTEND & CORS
# ─────────────────────────────────────────────────────────────────────────────────

# Production frontend URL (for CORS whitelist)
FRONTEND_URL=http://localhost:4000

# ─────────────────────────────────────────────────────────────────────────────────
# LOGGING
# ─────────────────────────────────────────────────────────────────────────────────

# Log level: 'debug', 'info', 'warn', 'error'
LOG_LEVEL=info

# Log authentication attempts (login, register, logout)
LOG_AUTH_ATTEMPTS=true

# ─────────────────────────────────────────────────────────────────────────────────
# MONITORING (Optional)
# ─────────────────────────────────────────────────────────────────────────────────

# Sentry DSN for error tracking
# SENTRY_DSN=https://your-key@sentry.io/project

# Security key for accessing sensitive health metrics in production
HEALTH_CHECK_KEY=your_secure_health_check_key
